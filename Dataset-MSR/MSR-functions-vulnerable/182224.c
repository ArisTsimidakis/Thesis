static int FUN1(VAR1 *VAR2, VAR3 *VAR4)
{
	int	VAR5;
	size_t VAR6 = VAR4->VAR7 >> 3;
	sc_apdu_t VAR8;
	u8 VAR9[300];
	u8 VAR10[4],*VAR11;

	FUN2(VAR2->VAR12, VAR13);

	
	FUN3(VAR2, &VAR8, VAR14, 0x22, 0x01, 0xB8);
	VAR8.VAR15=0x04;
	VAR10[0]=0x83;
	VAR10[1]=0x02;
	VAR10[2]=VAR4->VAR16;
	VAR10[3]=0x2A;
	VAR8.VAR4 = VAR10;
	VAR8.VAR17=4;
	VAR8.VAR15=4;
	VAR8.VAR18=0;

	VAR5=FUN4(VAR2, &VAR8, 0,0,0,0);
	FUN5(VAR2->VAR12, VAR19, VAR5, "");
	FUN5(VAR2->VAR12, VAR19, FUN6(VAR2,VAR8.VAR20,VAR8.VAR21),"");

	
	FUN3(VAR2, &VAR8, VAR14, 0x46,  0x00, 0x00);
	VAR8.VAR18      = 0;
	VAR10[0] = (VAR22)(VAR4->VAR7 >> 8);
	VAR10[1] = (VAR22)(VAR4->VAR7);
	VAR8.VAR4    = VAR10;
	VAR8.VAR15      = 2;
	VAR8.VAR17 = 2;

	VAR5 = FUN4(VAR2, &VAR8,0,0,0,0);
	FUN5(VAR2->VAR12, VAR19, VAR5, "");
	FUN5(VAR2->VAR12, VAR19, FUN6(VAR2,VAR8.VAR20,VAR8.VAR21),"");

	
	FUN3(VAR2, &VAR8, VAR23, 0xE6,  0x2A, VAR4->VAR16);
	VAR8.VAR24     = 0x80;
	VAR8.VAR25    = VAR9;
	VAR8.VAR26 = sizeof(VAR9);
	VAR8.VAR18      = 256;
	VAR5 = FUN4(VAR2, &VAR8,0,0,0,0);
	FUN5(VAR2->VAR12, VAR19, VAR5, "");
	FUN5(VAR2->VAR12, VAR19, FUN6(VAR2,VAR8.VAR20,VAR8.VAR21),"");
 
 	VAR4->VAR27 = malloc(VAR6);
 	if (!VAR4->VAR27)

		 FUN7(VAR2->VAR12, VAR13,VAR28);


 
 	VAR11=VAR9;

	assert(*VAR11=='');




 	VAR11+=2+VAR11[1];
 	

	assert(*VAR11=='');




 	++VAR11;
 	if(*VAR11++>0x80)
 	{
		 u8 VAR29=(*(VAR11-1))&0x0f;
		 size_t VAR30=0;
		 while(VAR29!=0)
		 {
			  VAR30=VAR30<<8;
			  VAR30+=*VAR11++;
			  --VAR29;
		 }
	}

	FUN8(VAR11,VAR6);
	memcpy(VAR4->VAR27,VAR11,VAR6);

	FUN7(VAR2->VAR12, VAR13,VAR31);
}